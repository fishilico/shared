# EICAR Anti Malware Test File

From <https://www.eicar.org/?page_id=3950> (<https://secure.eicar.org/eicar.com.txt>):

```text
X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
```

(68 bytes)

## The file is a legitimate DOS program

This is a .COM file for DOS: <https://en.wikipedia.org/wiki/COM_file>

> Since it lacks relocation information, it is loaded by the operating system at a pre-set address, at offset 0100h immediately following the PSP.

With `objdump -D -bbinary -mi8086 -Mintel`:

```text
 100:  58                     pop    ax               ; assume ax = 0
 101:  35 4f 21               xor    ax,0x214f        ; ax = 0x214f
 104:  50                     push   ax
 105:  25 40 41               and    ax,0x4140        ; ax = 0x0140
 108:  50                     push   ax
 109:  5b                     pop    bx               ; bx = 0x0140
 10a:  34 5c                  xor    al,0x5c          ; ax = 0x011c
 10c:  50                     push   ax
 10d:  5a                     pop    dx               ; dx = 0x011c
 10e:  58                     pop    ax               ; ax = 0x214f
 10f:  35 34 28               xor    ax,0x2834        ; ax = 0x097b
 112:  50                     push   ax
 113:  5e                     pop    si               ; si = 0x097b
 114:  29 37                  sub    WORD PTR [bx],si ; *0x0140 -= 0x097b
 116:  43                     inc    bx
 117:  43                     inc    bx               ; bx = 0x0142
 118:  29 37                  sub    WORD PTR [bx],si ; *0x0142 -= 0x097b
 11a:  7d 24                  jge    0x140            ; goto 140
 11c:  "EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$"
 140:  48 2b 48 2a
=> modified to:
 140:  cd 21                  int    0x21             ; Print String (ah=9, ds:dx=string ending in '$')
 142:  cd 20                  int    0x20             ; Program Terminate
```

So this DOS program prints `EICAR-STANDARD-ANTIVIRUS-TEST-FILE!`.
